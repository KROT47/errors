import HTTP_STATUS_CODES from'./http-status-codes.json';const Names={},Codes={},Options={};var useStack=!1;const mappers={};let freeCode=600;const _DEFAULT_ERROR_MAPPING={stack:['stack'],message:['message'],name:['constructor.name'],code:['code']},Errors={find(a){return'number'==typeof a?Codes[a]:Names[a]},isError(a){return a&&a.hasOwnProperty('explanation')&&a.hasOwnProperty('code')},errorToJSON(a,b){let c=b||_DEFAULT_ERROR_MAPPING,d={};for(const e in c)for(const b in c[e]){let f=a,g=c[e][b],h=g.split('.');for(const a in h){if('stack'==h[a]&&!useStack){f=null;break}f=h[a]in f?f[h[a]]:null}null!=f&&(d[e]=f)}return d},create,stacks(a){return null==a||void 0==a?useStack:void(useStack=a)},mapper(a,b){if(1<arguments.length)return void asArray(a).forEach((a)=>mappers[a]=b);if(Array.isArray(a))throw console.log('errName:',a),Error('errName must be string');return mappers[a]},mapError(a){const b=Errors.mapper(a.name);return b?b(a):a}};export default Errors;const JS_ERRORS={Error,EvalError,RangeError,ReferenceError,SyntaxError,TypeError,URIError};for(const a in JS_ERRORS)Errors.create({name:a,parent:JS_ERRORS[a]});for(let a in Errors.create({name:'HttpError'}),HTTP_STATUS_CODES)a=parseInt(a),HTTP_STATUS_CODES.hasOwnProperty(a)&&400<=a&&Errors.create({name:`Http${a}Error`,code:a,parent:Errors.HttpError,defaultMessage:HTTP_STATUS_CODES[a]});function create(a){var b,a=a||{},c=a.scope||Errors,d=a.parent||Error,e=a.defaultMessage||`An unexpected ${a.name} occurred.`,f=a.name,g=a.code||nextCode(),h=a.status,i=a.defaultExplanation,j=a.defaultResponse,k={};if(f in c){if(errorWasBuiltWithSameOptions(f,a))return Names[f];throw Error(`Error ${f} already defined`)}const l=c[f]=function(a,l,m){let n={};if(null!==typeof a&&'object'==typeof a&&(n=a,a=n.message||e,n.hasOwnProperty('stack')||n.hasOwnProperty('name')||n.hasOwnProperty('code')))throw Error('Properties \'stack\', \'name\' or \'code\' cannot be overridden');for(const o in n.status=n.status||h,a=a||e,l=l||i,m=m||j,d.call(this,a),Error.captureStackTrace(k,c[f]),Object.defineProperty(this,'stack',{configurable:!0,enumerable:!1,get(){return b||(b=k.stack.replace('[object Object]',`Error: ${this.message}`)),b}}),Object.defineProperty(this,'explanation',{value:n.explanation||l,configurable:!0,enumerable:!0}),Object.defineProperty(this,'response',{value:n.response||m,configurable:!0,enumerable:!0}),Object.defineProperty(this,'code',{value:n.code||g,configurable:!0,enumerable:!0}),Object.defineProperty(this,'status',{value:n.status||(HTTP_STATUS_CODES[g]?g:500),configurable:!0,enumerable:!0}),Object.defineProperty(this,'name',{value:f,configurable:!0,enumerable:!0}),Object.defineProperty(this,'message',{value:n.message||a,configurable:!0,enumerable:!0}),n)this.hasOwnProperty(o)||Object.defineProperty(this,o,{value:n[o],configurable:!0,enumerable:!0})};return l.prototype=Object.create(d.prototype,{constructor:{value:l,enumerable:!1,writable:!0,configurable:!0}}),Object.defineProperty(l.prototype,'name',{value:f,enumerable:!0}),Object.defineProperty(l,'isParentOfSome',{value(a){for(var b=a.length;b--;)if(a[b]instanceof this)return a[b]},enumerable:!0}),l.prototype.toString=function(){let a=`${this.name}: ${this.message}
            Code: ${this.code}`;return this.explanation&&(a+=`\nExplanation: ${this.explanation}`),this.response&&(a+=`\nResponse: ${this.response}`),Object.keys(this).filter(function(a){return 0>['name','message','status','code','response','explanation','stack'].indexOf(a)}).forEach(function(b){a+=`\n${b}: ${this[b]}`},this),useStack&&(a+=`\n${this.stack}`),a},l.prototype.toJSON=function(){return useStack?mixin(this,{stack:this.stack},!0):mixin(this,{},!0)},cache(f,g,l,a),l}function cache(a,b,c,d){Names[a]=c,Codes[b]=c,Options[a]=d}function errorWasBuiltWithSameOptions(a,b){return isEqual(Options[a],b)}function isEqual(c,a){const b=Object.keys(c),d=Object.keys(a);if(b.length!==d.length)return!1;for(var e=b.length;e--;){const d=b[e];if(c[d]!==a[d])return!1}return!0}function nextCode(){for(;Codes[freeCode];)freeCode+=1;return freeCode}function mixin(a,b,c){return b=b||{},a=a||{},Object.keys(a).forEach((d)=>{!b[d]&&c&&null!=a[d]&&void 0!=a[d]&&(b[d]=a[d])}),b}function asArray(a){return a instanceof Array?a:[a]}